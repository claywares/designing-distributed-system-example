# 负载均衡器演示

## 概述

负载均衡器是分布式系统中的关键组件，用于在多个后端服务实例之间分发传入的网络流量。

## 架构图

```
                    ┌─────────────────┐
                    │   Load Balancer │
                    │    (Nginx)      │
                    └─────────┬───────┘
                              │
           ┌──────────────────┼──────────────────┐
           │                  │                  │
    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
    │  Backend 1  │    │  Backend 2  │    │  Backend 3  │
    │   :8001     │    │   :8002     │    │   :8003     │
    └─────────────┘    └─────────────┘    └─────────────┘
```

## 负载均衡策略

1. **轮询 (Round Robin)**: 按顺序分发请求
2. **加权轮询 (Weighted Round Robin)**: 根据权重分发请求
3. **最少连接 (Least Connections)**: 分发到连接数最少的服务器
4. **IP Hash**: 根据客户端IP的hash值分发

## 本示例特性

- **健康检查**: 自动检测和排除不健康的后端服务
- **会话保持**: 支持基于cookie的会话保持
- **监控指标**: 提供负载均衡器和后端服务的指标
- **动态配置**: 支持运行时添加/移除后端服务

## 运行方式

```bash
# 启动所有服务
docker-compose up --build

# 扩展后端服务
docker-compose up --scale backend=5

# 测试负载均衡
for i in {1..10}; do curl http://localhost/api/info; done

# 查看Nginx状态
curl http://localhost/nginx_status
```
